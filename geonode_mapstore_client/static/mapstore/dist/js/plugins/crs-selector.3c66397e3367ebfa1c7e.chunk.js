(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[98129],{67925:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>te});var n=r(218721),o=r.n(n),l=r(264721),c=r.n(l),i=r(103651),a=r.n(i),u=r(727418),s=r.n(u),p=r(675263),f=r.n(p),y=r(124852),d=r.n(y),b=r(757588),h=r(322843),v=r(22222),m="CHANGE_CRS_INPUT_VALUE",g=r(801550),S=r(197395),w=r(805346),R=r(86638);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function E(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(c,e);var t,r,n,o,l=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(n);if(o){var r=k(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return E(this,e)});function c(){var e;C(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return I(_(e=l.call.apply(l,[this].concat(r))),"handleChange",(function(t){e.props.changeInputValue(t.target.value)})),e}return t=c,(r=[{key:"render",value:function(){var e=this,t=this.props.children;return d().createElement("div",{className:"dropdown-menu",style:{left:"auto",right:0}},d().createElement(b.ListGroupItem,{className:"ms-prj-header",bsSize:"sm"},d().createElement("div",null,d().createElement(w.Z,{msgId:"crsSelectorSelectedCRS"})),d().createElement("div",null,this.props.selected)),d().createElement(b.ListGroup,{style:{maxHeight:150,overflowY:"auto",marginBottom:0}},t.filter((function(t){return!e.props.value.trim()||-1!==t.props.children.indexOf(e.props.value)}))),d().createElement(b.FormControl,{ref:function(t){e.input=t},type:"text",placeholder:(0,R.S$)(this.context.messages,"crsSelectorFilterPlaceholder"),onChange:this.handleChange,value:this.props.value}))}}])&&O(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(d().Component);I(A,"propTypes",{selected:f().string,value:f().string,changeInputValue:f().func}),I(A,"contextTypes",{messages:f().object}),I(A,"defaultProps",{value:"",changeInputValue:function(){}});const T=A;var x=r(815135);var B=r(673781),D=r(607147),L=r(731255),G=r(675110),N=r(800827),V=r(55105),F=r(93152),M=r(274621),Z=r(986267),H=r(282467);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function Q(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Y(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var W=(0,x.Z)(H.Z),X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(u,e);var t,r,n,l,i=(n=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(n);if(l){var r=q(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Q(this,e)});function u(){var e;z(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(Y(e=i.call.apply(i,[this].concat(r))),"state",{toggled:!1}),e}return t=u,r=[{key:"render",value:function(){var e=this,t=[],r={};for(var n in Object.keys(this.props.availableCRS).length&&(r=(0,Z.filterCRSList)(this.props.availableCRS,this.props.filterAllowedCRS,this.props.additionalCRS,this.props.projectionDefs)),r)r.hasOwnProperty(n)&&t.push({value:n});var l=(0,Z.normalizeSRS)(this.props.selected,this.props.filterAllowedCRS),i=["EPSG:4326","EPSG:3857","EPSG:900913"],u=["wms","osm","tileprovider","empty","wmts"],s=function(t){a()(i,t)>-1||a()(u,e.props.currentBackground.type)>-1||e.props.currentBackground.allowedSRS&&o()(e.props.currentBackground.allowedSRS,t)?e.props.setCrs(t):e.props.onError({title:"error",message:"notification.incompatibleBackgroundAndProjection",action:{label:"close"},position:"tc",uid:"3"})};s(l);var p=c()(this.props.allowedRoles,"ALL")||c()(this.props.allowedRoles,this.props.currentRole);return this.props.enabled&&p?d().createElement(b.Dropdown,{dropup:!0,className:"ms-prj-selector",onToggle:function(t){return e.setState({toggled:t})}},d().createElement(W,{bsRole:"toggle",bsStyle:"primary",className:"map-footer-btn btn-".concat(this.state.toggled?"success":"primary"),tooltip:d().createElement(w.Z,{msgId:"showCrsSelector"}),tooltipPosition:"top"},d().createElement(b.Glyphicon,{glyph:"crs"})),d().createElement(T,{bsRole:"menu",value:this.props.value,selected:l,projectionDefs:this.props.projectionDefs,filterAllowedCRS:this.props.filterAllowedCRS,additionalCRS:this.props.additionalCRS,changeInputValue:function(t){return e.props.typeInput(t)}},t.map((function(e){return d().createElement(b.ListGroupItem,{key:e.value,active:l===e.value,onClick:function(e){return s(e.target.textContent)},eventKey:e.value},e.value)})))):null}}],r&&K(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(d().Component);J(X,"propTypes",{selected:f().string,value:f().string,projections:f().array,availableCRS:f().object,filterAllowedCRS:f().array,projectionDefs:f().array,additionalCRS:f().object,setCrs:f().func,typeInput:f().func,enabled:f().bool,currentBackground:f().object,onError:f().func,allowedRoles:f().array,currentRole:f().string}),J(X,"defaultProps",{availableCRS:(0,Z.getAvailableCRS)(),setCrs:function(){},typeInput:function(){},enabled:!0,allowedRoles:["ALL"]});var ee=(0,h.$j)((0,v.P1)(M.L3,G.DP,N.uy,N.pb,(function(e){return e&&e.crsselector&&e.crsselector.value}),L.eK,F.c0,V.VM,D.QF,D._d,D.h,B.cM,(function(e,t,r,n,o,l,c,i,a,u,s,p){return{currentRole:e,currentBackground:t,selected:r,projectionDefs:n,value:o,enabled:!("EDIT"===l||c||i||a||u||s||p)}})),{typeInput:function(e){return{type:m,value:e}},setCrs:g.NH,onError:S.vU})(X);const te={CRSSelectorPlugin:s()(ee,{disablePluginIf:"{state('mapType') === 'leaflet'}",MapFooter:{name:"crsSelector",position:10,tool:!0,priority:1}}),reducers:{crsselector:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{projections:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===m?s()({},e,{value:t.value}):e}},epics:{}}},103651:(e,t,r)=>{var n=r(442118),o=r(640554),l=Math.max;e.exports=function(e,t,r){var c=null==e?0:e.length;if(!c)return-1;var i=null==r?0:o(r);return i<0&&(i=l(c+i,0)),n(e,t,i)}}}]);